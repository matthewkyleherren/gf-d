{"componentChunkName":"component---src-templates-single-index-js","path":"/blog/preventing-node-sass-or-any-specific-dependency-from-installing","result":{"pageContext":{"id":"cG9zdDo5Nzky","databaseId":9792,"title":"Preventing Node-Sass (Or Any Specific Dependency) From Installing","uri":"/preventing-node-sass-or-any-specific-dependency-from-installing/","slug":"preventing-node-sass-or-any-specific-dependency-from-installing","date":"2022-01-21T05:48:00","excerpt":"<p>If you’re using sass&nbsp;in your frontend projects (which we definitely recommend!), you’ve probably run into node-sass&nbsp;in one way or another.&nbsp;Node-sass is a C++ add on for NodeJS that binds libsass, the C language compiler for the sass language. Both node-sass&nbsp;and&nbsp;libsass&nbsp;have been&nbsp;deprecated&nbsp;in favor of Dart Sass (sass) since October 2020. While they were built to be<a class=\"moretag\" href=\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/\">Read More</a></p>\n","content":"\n<p>If you’re using sass&nbsp;in your frontend projects (which we definitely recommend!), you’ve probably run into node-sass&nbsp;in one way or another.&nbsp;Node-sass is a C++ add on for NodeJS that binds libsass, the C language compiler for the sass language. </p>\n\n\n\n<p>Both node-sass&nbsp;and&nbsp;libsass&nbsp;have been&nbsp;<a href=\"https://sass-lang.com/blog/libsass-is-deprecated\">deprecated</a>&nbsp;in favor of Dart Sass (sass) since October 2020. While they were built to be fast, they have the disadvantage of long build times, and breaking unexpectedly when using a new NodeJS version—or missing any required tooling for building the dependencies.</p>\n\n\n\n<p>In the end of 2021 (and after many such issues over the years), the OpenWeb team ran into a problem preventing us from building most frontend projects due to a platform change that removed one of the dependencies used by the&nbsp;node-sass&nbsp;build process. In most cases, we were migrated to&nbsp;sass, but multiple dependencies were still referencing&nbsp;node-sass —meaning that it was being installed and compiled, but not used.</p>\n\n\n\n<p class=\"has-30-18-font-size\">We Were Faced With Two Choices</p>\n\n\n\n<ol><li>Update all nested dependencies to use sass and update all projects to use the new versions of said dependencies, or</li><li>Find a way to prevent node-sass from being installed downstream even if referenced by a dependency.</li></ol>\n\n\n\n<p>Normally, if you want to prevent something from being used, you can use&nbsp;null-loader&nbsp;(on Webpack 4), or disable the dependency using an&nbsp;<a href=\"https://github.com/webpack-contrib/null-loader\">alias</a>&nbsp;(on Webpack 5), but this will not prevent the dependency from being installed and built—only from being included in your built asset.</p>\n\n\n\n<p>Since we use&nbsp;yarn&nbsp;1 (npm&nbsp;and&nbsp;yarn&nbsp;2 instructions included below) as our package manager, a good place to start looking was&nbsp;yarns&nbsp;<a href=\"https://classic.yarnpkg.com/lang/en/docs/selective-version-resolutions/\">resolutions</a> section, which allows resolving multiple versions of a dependency to one version.</p>\n\n\n\n<p>The issue here was that&nbsp;resolutions&nbsp;allows us to specify a specific version, but not disable the dependency entirely as in Webpack 5. The&nbsp;yarn&nbsp;documentation also specifies that you can use a local file in the&nbsp;dependency&nbsp;section (file:&#8230;) but does not specify the same for&nbsp;resolutions. </p>\n\n\n\n<p>This meant that going by the documentation, you could redirect a downstream dependency to a local file, but not anything used by upstream dependencies. </p>\n\n\n\n<p>Nonetheless, we tried specifying a local stub dependency for&nbsp;node-sass&nbsp;to try to prevent it from installing the actual dependency, and it worked with&nbsp;resolutions&nbsp;as well! Now we could easily redirect&nbsp;node-sass&nbsp;to a stub, prevent it from being installed without updating any dependencies, and solve the issue rather quickly.</p>\n\n\n\n<p class=\"has-30-18-font-size\">Our Step-By-Step Solution</p>\n\n\n\n<ol><li>Install&nbsp;sass&nbsp;using&nbsp;yarn add -D sass&nbsp;if not installed.</li><li>Create a folder named&nbsp;dependency-stub&nbsp;in the project root, housing a single file named&nbsp;index.js&nbsp;containing the line&nbsp;module.exports = {};&nbsp;(which is the stub we will redirect to using&nbsp;resolutions).</li></ol>\n\n\n\n<ul><li>yarn&nbsp;2 &#8211; add a&nbsp;package.json&nbsp;file to the directory containing&nbsp;{ &#8220;name: &#8220;node-sass&#8221;, &#8220;version&#8221;: &#8220;0.0.0&#8221; }</li><li>npm&nbsp;&#8211; see note under step 3.</li></ul>\n\n\n\n<ol start=\"3\"><li>In&nbsp;package.json&nbsp;add&nbsp;&#8220;node-sass&#8221;: &#8220;file:dependency-stub&#8221;&nbsp;to the&nbsp;resolutions&nbsp;(or&nbsp;overrides&nbsp;if using NPM) section.</li></ol>\n\n\n\n<ul><li>npm&nbsp;&#8211; use the&nbsp;overrides&nbsp;section rather than&nbsp;resolutions, and since&nbsp;npm&nbsp;file urls are relative to the current dependency, you can either use an absolute path to&nbsp;dependency-stub&nbsp;(possibly placing it in your home directory), a URL for a stub module, or a GitHub URL for a stub module.</li></ul>\n\n\n\n<ol start=\"4\"><li>In&nbsp;tsconfig.json&nbsp;add&nbsp;&#8220;dependency-stub&#8221;&nbsp;to the&nbsp;include&nbsp;array (to prevent ESLint from throwing errors regarding the file not being in the project).</li></ol>\n\n\n\n<ul><li>npm&nbsp;&#8211; assuming&nbsp;dependency-stub&nbsp;isn’t in your project directory, this is not needed.</li></ul>\n\n\n\n<p>(Step 3 of the process can be reused for any arbitrary C++ NodeJS add on, assuming it isn’t used).</p>\n\n\n\n<p>And that was it! node-sass&nbsp;stopped installing in all projects and the issue was resolved (save for a few projects with out of date&nbsp;sass-loaders&nbsp;which needed manual updating). Hopefully, this will help anyone else needing to quickly remove&nbsp;node-sass.</p>\n","owHidePublishDate":false,"seo":{"canonical":"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/","title":"Preventing Node-Sass (Or Any Specific Dependency) From Installing | OpenWeb","metaDesc":"If you’re using sass in your frontend projects, you’ve probably run into node-sass in one way or another. This guide will help other teams who need to quickly remove node-sass.","focuskw":"","metaRobotsNoindex":"index","metaRobotsNofollow":"follow","opengraphAuthor":"","opengraphDescription":"If you’re using sass in your frontend projects, you’ve probably run into node-sass in one way or another. This guide will help other teams who need to quickly remove node-sass.","opengraphTitle":"Preventing Node-Sass (Or Any Specific Dependency) From Installing","opengraphImage":{"sourceUrl":"https://www.openweb.com/uploads/2022/01/Engineering-LO1-1140x460-1.jpg"},"opengraphUrl":"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/","opengraphSiteName":"OpenWeb","opengraphPublishedTime":"2022-01-21T05:48:00+00:00","opengraphModifiedTime":"2022-01-21T14:46:03+00:00","twitterTitle":"Preventing Node-Sass (Or Any Specific Dependency) From Installing","twitterDescription":"If you’re using sass in your frontend projects, you’ve probably run into node-sass in one way or another. This guide will help other teams who need to quickly remove node-sass.","twitterImage":{"sourceUrl":"https://www.openweb.com/uploads/2022/01/Engineering-LO1-1140x460-1.jpg"},"schema":{"raw":"{\"@context\":\"https://schema.org\",\"@graph\":[{\"@type\":\"Organization\",\"@id\":\"https://wordpress.openweb.com/#organization\",\"name\":\"OpenWeb\",\"url\":\"https://wordpress.openweb.com/\",\"sameAs\":[\"https://www.facebook.com/OpenWebHQ\",\"https://www.linkedin.com/company/openwebhq/\",\"https://twitter.com/OpenWebHQ\"],\"logo\":{\"@type\":\"ImageObject\",\"@id\":\"https://wordpress.openweb.com/#logo\",\"inLanguage\":\"en-US\",\"url\":\"https://www.openweb.com/uploads/2020/06/logo-header-desktop@3x.png\",\"contentUrl\":\"https://www.openweb.com/uploads/2020/06/logo-header-desktop@3x.png\",\"width\":573,\"height\":165,\"caption\":\"OpenWeb\"},\"image\":{\"@id\":\"https://wordpress.openweb.com/#logo\"}},{\"@type\":\"WebSite\",\"@id\":\"https://wordpress.openweb.com/#website\",\"url\":\"https://wordpress.openweb.com/\",\"name\":\"OpenWeb\",\"description\":\"It all starts with a conversation\",\"publisher\":{\"@id\":\"https://wordpress.openweb.com/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https://wordpress.openweb.com/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https://www.openweb.com/uploads/2022/01/Engineering-LO1-1140x460-1.jpg\",\"contentUrl\":\"https://www.openweb.com/uploads/2022/01/Engineering-LO1-1140x460-1.jpg\",\"width\":1140,\"height\":460},{\"@type\":\"WebPage\",\"@id\":\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/#webpage\",\"url\":\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/\",\"name\":\"Preventing Node-Sass (Or Any Specific Dependency) From Installing | OpenWeb\",\"isPartOf\":{\"@id\":\"https://wordpress.openweb.com/#website\"},\"primaryImageOfPage\":{\"@id\":\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/#primaryimage\"},\"datePublished\":\"2022-01-21T05:48:00+00:00\",\"dateModified\":\"2022-01-21T14:46:03+00:00\",\"description\":\"If you\\u2019re using sass in your frontend projects, you\\u2019ve probably run into node-sass in one way or another. This guide will help other teams who need to quickly remove node-sass.\",\"breadcrumb\":{\"@id\":\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://wordpress.openweb.com/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Tech\",\"item\":\"https://wordpress.openweb.com/category/tech/\"},{\"@type\":\"ListItem\",\"position\":3,\"name\":\"Preventing Node-Sass (Or Any Specific Dependency) From Installing\"}]},{\"@type\":\"Article\",\"@id\":\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/#article\",\"isPartOf\":{\"@id\":\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/#webpage\"},\"author\":{\"@id\":\"https://wordpress.openweb.com/#/schema/person/d080beea8ceee08d1f63e76ad7b20b7d\"},\"headline\":\"Preventing Node-Sass (Or Any Specific Dependency) From Installing\",\"datePublished\":\"2022-01-21T05:48:00+00:00\",\"dateModified\":\"2022-01-21T14:46:03+00:00\",\"mainEntityOfPage\":{\"@id\":\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/#webpage\"},\"wordCount\":718,\"commentCount\":0,\"publisher\":{\"@id\":\"https://wordpress.openweb.com/#organization\"},\"image\":{\"@id\":\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/#primaryimage\"},\"thumbnailUrl\":\"https://www.openweb.com/uploads/2022/01/Engineering-LO1-1140x460-1.jpg\",\"articleSection\":[\"Tech\"],\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https://wordpress.openweb.com/preventing-node-sass-or-any-specific-dependency-from-installing/#respond\"]}]},{\"@type\":\"Person\",\"@id\":\"https://wordpress.openweb.com/#/schema/person/d080beea8ceee08d1f63e76ad7b20b7d\",\"name\":\"OpenWeb\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https://wordpress.openweb.com/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https://secure.gravatar.com/avatar/ca9e32486cc06e1a1d881b822a46728c?s=96&d=mm&r=g\",\"contentUrl\":\"https://secure.gravatar.com/avatar/ca9e32486cc06e1a1d881b822a46728c?s=96&d=mm&r=g\",\"caption\":\"OpenWeb\"}}]}"}},"categories":{"edges":[{"node":{"name":"Tech","uri":"/category/tech/","posts":{"edges":[{"node":{"id":"cG9zdDo5Nzky","databaseId":9792,"title":"Preventing Node-Sass (Or Any Specific Dependency) From Installing","uri":"/preventing-node-sass-or-any-specific-dependency-from-installing/","date":"2022-01-21T05:48:00","categories":{"edges":[{"node":{"name":"Tech","uri":"/category/tech/"}}]},"author":{"node":{"name":"OpenWeb","uri":"/author/theowadmin/"}},"large":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2022/01/Engineering-LO1-1140x460-1.jpg","title":"engineering","altText":"","mediaDetails":{"width":1140,"height":460}}},"medium":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2022/01/Engineering-LO1-1140x460-1-555x332.jpg","title":"engineering","altText":"","mediaDetails":{"width":1140,"height":460}}},"thumbnail":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2022/01/Engineering-LO1-1140x460-1-150x150.jpg","title":"engineering","altText":"","mediaDetails":{"width":1140,"height":460}}},"multipleAuthors":{"authors":null}}},{"node":{"id":"cG9zdDo5NTcx","databaseId":9571,"title":"Where Publishers Can Maximize Mobile Audience Engagement","uri":"/where-publishers-can-maximize-mobile-audience-engagement/","date":"2021-11-12T14:28:16","categories":{"edges":[{"node":{"name":"Articles","uri":"/category/articles/"}},{"node":{"name":"Tech","uri":"/category/tech/"}}]},"author":{"node":{"name":"OpenWeb","uri":"/author/theowadmin/"}},"large":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2021/11/inapp-1140x460.jpg","title":"inapp","altText":"","mediaDetails":{"width":2560,"height":1033}}},"medium":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2021/11/inapp-555x332.jpg","title":"inapp","altText":"","mediaDetails":{"width":2560,"height":1033}}},"thumbnail":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2021/11/inapp-150x150.jpg","title":"inapp","altText":"","mediaDetails":{"width":2560,"height":1033}}},"multipleAuthors":{"authors":null}}},{"node":{"id":"cG9zdDo5MjYy","databaseId":9262,"title":"Local News Can Win Their Uphill Battle","uri":"/local-news-can-win-their-uphill-battle/","date":"2021-09-14T00:17:54","categories":{"edges":[{"node":{"name":"Articles","uri":"/category/articles/"}},{"node":{"name":"Tech","uri":"/category/tech/"}}]},"author":{"node":{"name":"OpenWeb","uri":"/author/theowadmin/"}},"large":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2021/09/utsav-srestha-HeNrEdA4Zp4-unsplash-1140x460-1.jpg","title":"utsav-srestha-HeNrEdA4Zp4-unsplash-1140×460","altText":"","mediaDetails":{"width":1140,"height":460}}},"medium":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2021/09/utsav-srestha-HeNrEdA4Zp4-unsplash-1140x460-1-555x332.jpg","title":"utsav-srestha-HeNrEdA4Zp4-unsplash-1140×460","altText":"","mediaDetails":{"width":1140,"height":460}}},"thumbnail":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2021/09/utsav-srestha-HeNrEdA4Zp4-unsplash-1140x460-1-150x150.jpg","title":"utsav-srestha-HeNrEdA4Zp4-unsplash-1140×460","altText":"","mediaDetails":{"width":1140,"height":460}}},"multipleAuthors":{"authors":null}}}]}}}]},"author":{"node":{"name":"OpenWeb","uri":"/author/theowadmin/"}},"large":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2022/01/Engineering-LO1-1140x460-1.jpg","title":"engineering","altText":"","mediaDetails":{"width":1140,"height":460}}},"medium":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2022/01/Engineering-LO1-1140x460-1-555x332.jpg","title":"engineering","altText":"","mediaDetails":{"width":1140,"height":460}}},"thumbnail":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2022/01/Engineering-LO1-1140x460-1-150x150.jpg","title":"engineering","altText":"","mediaDetails":{"width":1140,"height":460}}},"multipleAuthors":{"authors":null},"hubSpotDownloadFormPageMeta":{"hubspotDownloadForm":{"downloadLabel":"Click to download","downloadLink":null,"fieldGroupName":"hubspot_download_form","formHeadline":"Read more about our work","formId":null,"formPortalid":"5731985","thankYouMessage":"<h2>Thanks for submitting the form.</h2>\n<p>Your content will be arriving via email.</p>\n"}},"relatedPosts":[{"id":"cG9zdDo5NTcx","databaseId":9571,"title":"Where Publishers Can Maximize Mobile Audience Engagement","uri":"/where-publishers-can-maximize-mobile-audience-engagement/","date":"2021-11-12T14:28:16","categories":{"edges":[{"node":{"name":"Articles","uri":"/category/articles/"}},{"node":{"name":"Tech","uri":"/category/tech/"}}]},"author":{"node":{"name":"OpenWeb","uri":"/author/theowadmin/"}},"large":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2021/11/inapp-1140x460.jpg","title":"inapp","altText":"","mediaDetails":{"width":2560,"height":1033}}},"medium":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2021/11/inapp-555x332.jpg","title":"inapp","altText":"","mediaDetails":{"width":2560,"height":1033}}},"thumbnail":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2021/11/inapp-150x150.jpg","title":"inapp","altText":"","mediaDetails":{"width":2560,"height":1033}}},"multipleAuthors":{"authors":null}},{"id":"cG9zdDo5MjYy","databaseId":9262,"title":"Local News Can Win Their Uphill Battle","uri":"/local-news-can-win-their-uphill-battle/","date":"2021-09-14T00:17:54","categories":{"edges":[{"node":{"name":"Articles","uri":"/category/articles/"}},{"node":{"name":"Tech","uri":"/category/tech/"}}]},"author":{"node":{"name":"OpenWeb","uri":"/author/theowadmin/"}},"large":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2021/09/utsav-srestha-HeNrEdA4Zp4-unsplash-1140x460-1.jpg","title":"utsav-srestha-HeNrEdA4Zp4-unsplash-1140×460","altText":"","mediaDetails":{"width":1140,"height":460}}},"medium":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2021/09/utsav-srestha-HeNrEdA4Zp4-unsplash-1140x460-1-555x332.jpg","title":"utsav-srestha-HeNrEdA4Zp4-unsplash-1140×460","altText":"","mediaDetails":{"width":1140,"height":460}}},"thumbnail":{"node":{"sourceUrl":"https://www.openweb.com/uploads/2021/09/utsav-srestha-HeNrEdA4Zp4-unsplash-1140x460-1-150x150.jpg","title":"utsav-srestha-HeNrEdA4Zp4-unsplash-1140×460","altText":"","mediaDetails":{"width":1140,"height":460}}},"multipleAuthors":{"authors":null}}],"form":{"title":"Subscribe to our blog","portalId":"5731985","formId":"11f68969-1b7e-490f-8883-b20247ead142"},"siteUrl":"https://www.openweb.com","postUri":"/blog/preventing-node-sass-or-any-specific-dependency-from-installing","singlePostHubSpotForm":{"downloadLabel":"Click to download","downloadLink":null,"fieldGroupName":"hubspot_download_form","formHeadline":"Read more about our work","formId":null,"formPortalid":"5731985","thankYouMessage":"<h2>Thanks for submitting the form.</h2>\n<p>Your content will be arriving via email.</p>\n"}}},"staticQueryHashes":["199889258","2615726974","2938868345"]}